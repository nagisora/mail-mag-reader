### メルマガリーダー要件定義書

#### 機能要件

1. **ユーザー認証**
   - Supabaseを使用してユーザー登録とログイン機能を実装。
   - メールアドレスとパスワードによる認証。
   - **今後、Google認証を追加し、ユーザーがGoogleアカウントでログインできるようにする。**  {{ edit_1 }}

2. **メルマガの管理**
   - メルマガの作成、編集、削除機能。
   - メルマガの内容はMarkdown形式で保存。

3. **読んだ位置の記録**
   - 各ユーザーごとに、メルマガを読んだ位置をSupabaseに保存。
   - 読み進めた位置を特定するためのフィールド（例：メルマガID、ユーザーID、読み進めた位置）。

4. **続きから読む機能**
   - メルマガを開いた際に、前回の読み進めた位置から自動的に表示。
   - 位置を保存するためのAPIエンドポイントを作成（例：`POST /api/save-progress`）。

5. **Gmailからのメルマガ取得と照合**
   - 管理者がGoogle Apps Script (GAS)を使用して、Gmailから特定のラベルを持つメルマガを自動的に取得し、マスターメルマガとしてSupabaseに保存。
   - 一般ユーザーは、自身の所有するメルマガの本文をフォームにコピペ。
   - システムは入力されたメルマガ本文とDBのマスターメルマガを照合し、95%以上一致した場合のみ閲覧を許可。

6. **インターフェース**
   - Shadcn/uiを使用して、ユーザーフレンドリーなUIを構築。
   - メルマガのリスト表示、詳細表示、読み進めるためのボタンを設置。

7. **レスポンシブデザイン**
   - モバイルデバイスでも快適に読めるようにレスポンシブに設計。
   - スマートフォンでの閲覧を優先したUIデザイン。

#### 非機能要件

1. **パフォーマンス**
   - Vercelを使用してデプロイし、パフォーマンスを最適化。

2. **セキュリティ**
   - ユーザー情報やメルマガデータの保護。
   - 認証されたユーザーのみがメルマガにアクセスできるようにする。
   - メルマガの内容照合による不正アクセス防止。

3. **スケーラビリティ**
   - Supabaseを利用して、データベースのスケーラビリティを確保。

#### 開発環境

- **フロントエンド**: Next.js (TypeScript)
- **データベース**: Supabase
- **ホスティング**: Vercel
- **UIライブラリ**: Shadcn/ui
- **Gmail処理**: Google Apps Script (GAS)

#### 実装の流れ

1. **プロジェクトのセットアップ**
   - Next.jsプロジェクトを作成し、TypeScriptを設定。

2. **Supabaseのセットアップ**
   - Supabaseで新しいプロジェクトを作成し、必要なテーブルを設計。

3. **認証機能の実装**
   - Supabaseの認証APIを利用して、ユーザー登録とログイン機能を実装。

4. **メルマガ機能の実装**
   - メルマガのCRUD操作を実装。

5. **GASスクリプトの作成**
   - Gmailからメルマガを取得するGASスクリプトを作成し、Supabaseに保存。

6. **メルマガ照合機能の実装**
   - ユーザーが入力したメルマガ本文とマスターメルマガを照合するロジックを実装。
   - 95%以上の一致度を判定するアルゴリズムを開発。

7. **読み進めた位置の保存機能**
   - 読み進めた位置を記録するAPIエンドポイントを作成。

8. **UIのデザイン**
   - Shadcn/uiを使って、ユーザーインターフェースを構築。
   - スマートフォン優先のレスポンシブデザインを実装。

9. **テストとデプロイ**
   - Vercelにデプロイし、動作確認。

### 追加要件
- メルマガはスマホで読むことが中心のため、PCよりもスマホで見て快適なUIとなるよう優先する。
- メルマガの照合機能により、正規のユーザーのみがコンテンツにアクセスできるようにする。
